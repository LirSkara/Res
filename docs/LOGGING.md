# QRes OS 4 - –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è QRes OS 4 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ —Ç–∏–ø–∞–º –∏ —É—Ä–æ–≤–Ω—è–º –≤–∞–∂–Ω–æ—Å—Ç–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

```
logs/
‚îú‚îÄ‚îÄ .gitkeep                    # –§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞–ø–∫–∏ –≤ Git
‚îú‚îÄ‚îÄ api_requests.log            # –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã (INFO, WARNING)
‚îú‚îÄ‚îÄ api_requests_YYYY-MM-DD.json  # –î–µ—Ç–∞–ª—å–Ω—ã–µ JSON –ª–æ–≥–∏ –ø–æ –¥–Ω—è–º
‚îú‚îÄ‚îÄ errors.log                  # –û—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (WARNING, ERROR)
‚îî‚îÄ‚îÄ archive/                    # –ê—Ä—Ö–∏–≤ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
```

## üéØ –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### INFO
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ API –∑–∞–ø—Ä–æ—Å—ã (200, 201, 204)
- üîç CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —ç–º–æ–¥–∑–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏
- üöÄ –°–æ–±—ã—Ç–∏—è –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### WARNING  
- ‚ö†Ô∏è HTTP –æ—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ (400-499)
- üîç 404 Not Found
- üìù 422 Validation Error
- üö´ 403 Forbidden

### ERROR
- üí• –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (Exception)
- üî• –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (500+)
- üíî –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìä –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

### API Requests Log
```
2025-07-06 19:48:03 [INFO] üîç READ | GET /health | 200 | 0.4ms | –ê–Ω–æ–Ω–∏–º–Ω—ã–π
2025-07-06 19:48:08 [WARNING] üîç READ | GET /nonexistent | 404 | 0.45ms | –ê–Ω–æ–Ω–∏–º–Ω—ã–π
```

### Errors Log
```
2025-07-06 19:49:53 [ERROR] qres_errors: –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: Exception: Test error
–ó–∞–ø—Ä–æ—Å: GET http://localhost:8000/test/error
–ö–ª–∏–µ–Ω—Ç: 127.0.0.1
User-Agent: curl/8.7.1
Traceback:
[–ø–æ–ª–Ω—ã–π traceback]
```

### JSON Log
```json
{
  "timestamp": "2025-07-06T19:48:03",
  "operation": "üîç READ",
  "method": "GET",
  "path": "/health",
  "status_code": 200,
  "response_time_ms": 0.4,
  "user": "–ê–Ω–æ–Ω–∏–º–Ω—ã–π",
  "client_ip": "127.0.0.1"
}
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Development —Ä–µ–∂–∏–º
- –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å + —Ñ–∞–π–ª—ã
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ –æ—Ç–≤–µ—Ç–∞—Ö API
- –í—Å–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã

### Production —Ä–µ–∂–∏–º
- –¢–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°–∫—Ä—ã—Ç–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥

## üõ†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. APIRequestLoggingMiddleware
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- –ò–∑–º–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ JWT —Ç–æ–∫–µ–Ω—É
- –°–æ–∑–¥–∞–µ—Ç JSON –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### 2. Error Handlers
- `general_exception_handler`: –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- `http_exception_handler`: HTTP –æ—à–∏–±–∫–∏
- `validation_exception_handler`: –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 3. –õ–æ–≥–≥–µ—Ä—ã
- `api_logger`: API –∑–∞–ø—Ä–æ—Å—ã –∏ –æ–±—â–∏–µ —Å–æ–±—ã—Ç–∏—è
- `error_logger`: –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å logrotate –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sentry/DataDog –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤
3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –ü–∞—Ä—Å–∏–Ω–≥ JSON –ª–æ–≥–æ–≤ –¥–ª—è –º–µ—Ç—Ä–∏–∫
4. **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤

### –¢–∏–ø–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É (RPS)
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (response time)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø–æ —Ç–∏–ø–∞–º
- –¢–æ–ø API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ IP)

## üö® –ê–ª–µ—Ä—Ç—ã

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è:
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ 5xx –æ—à–∏–±–æ–∫
- –†–æ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –≤—ã—à–µ 1000ms
- –ß–∞—Å—Ç—ã–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –æ—à–∏–±–∫–∏
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–Ω–æ–≥–æ 404/403)

## üéõÔ∏è –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ª–æ–≥–≥–µ—Ä–æ–≤:

```python
# –í app/main.py
custom_logger = logging.getLogger("custom_component")
custom_logger.setLevel(logging.INFO)
```

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è! üöÄ
